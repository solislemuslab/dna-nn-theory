# Final plots in the manuscript (BMC)
Necessary package:
```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(scales)
```

Color palettes
```{r}
library(viridis)
library(RColorBrewer)
cbp1 <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
          "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
display.brewer.all(colorblindFriendly = TRUE)
```

## Role of dimension/layers

Models:
- CNN-Nguyen (original 2D, extra 1D)
- CNN-Zeng (original 2 layers, 3 layers, 4 layers)

### Plotting accuracy

Reading the data:
```{r}
nguyen2dhistone = read.table("../cn/results/cnn_nguyen_2_conv2d-histone-accuracy.csv", header=TRUE, sep=",")
nguyen2dsplice = read.table("../cn/results/cnn_nguyen_2_conv2d-splice-accuracy.csv", header=TRUE, sep=",")
nguyen2dmotif = read.table("../cn/results/cnn_nguyen_2_conv2d-motif_discovery-accuracy.csv", header=TRUE, sep=",")


nguyen1dhistone = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-histone-accuracy.csv", header=TRUE, sep=",")
nguyen1dsplice = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-splice-accuracy.csv", header=TRUE, sep=",")
nguyen1dmotif = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-motif_discovery-accuracy.csv", header=TRUE, sep=",")

zeng2histone = read.table("../cn/results/cnn_zeng_2_conv2d-histone-accuracy.csv", header=TRUE, sep=",")
zeng2splice = read.table("../cn/results/cnn_zeng_2_conv2d-splice-accuracy.csv", header=TRUE, sep=",")
zeng2motif = read.table("../cn/results/cnn_zeng_2_conv2d-motif_discovery-accuracy.csv", header=TRUE, sep=",")

zeng3histone = read.table("../cn/results/cnn_zeng_3_conv2d-histone-accuracy.csv", header=TRUE, sep=",")
zeng3splice = read.table("../cn/results/cnn_zeng_3_conv2d-splice-accuracy.csv", header=TRUE, sep=",")
zeng3motif = read.table("../cn/results/cnn_zeng_3_conv2d-motif_discovery-accuracy.csv", header=TRUE, sep=",")

zeng4histone = read.table("../cn/results/cnn_zeng_4_conv2d-histone-accuracy.csv", header=TRUE, sep=",")
zeng4splice = read.table("../cn/results/cnn_zeng_4_conv2d-splice-accuracy.csv", header=TRUE, sep=",")
zeng4motif = read.table("../cn/results/cnn_zeng_4_conv2d-motif_discovery-accuracy.csv", header=TRUE, sep=",")


## Appending all data
histone = rbind(nguyen2dhistone, nguyen1dhistone, zeng2histone, zeng3histone, zeng4histone)
histone2 = gather(histone, "type", "acc")
histone2$model = rep(c("CNN-Nguyen2D", "CNN-Nguyen2D+1D", "CNN-Zeng2", "CNN-Zeng3", "CNN-Zeng4"),3)
histone2

splice = rbind(nguyen2dsplice, nguyen1dsplice, zeng2splice, zeng3splice, zeng4splice)
splice2 = gather(splice, "type", "acc")
splice2$model = rep(c("CNN-Nguyen2D", "CNN-Nguyen2D+1D", "CNN-Zeng2", "CNN-Zeng3", "CNN-Zeng4"),3)
splice2

motif = rbind(nguyen2dmotif, nguyen1dmotif, zeng2motif, zeng3motif, zeng4motif)
motif2 = gather(motif, "type", "acc")
motif2$model = rep(c("CNN-Nguyen2D", "CNN-Nguyen2D+1D", "CNN-Zeng2", "CNN-Zeng3", "CNN-Zeng4"),3)
motif2
```

Plots Splice data:
```{r}
splice2 = within(splice2, type<-factor(type, labels=c("training", "testing", "validating")))
splice2 = within(splice2, type<-factor(type, levels=c("training", "validating", "testing")))

splice3 = within(splice2, model<-factor(model))
splice3 = within(splice3, model<- factor(model, labels=c("Nguyen2D", "Nguyen2D+1D", "Zeng2", "Zeng3", "Zeng4")))

p = ggplot(splice3, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("CNN") + ylab("") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-dimension-layers-acc.pdf",height=12, width=9)
p
dev.off()
```

Plots Histone data:
```{r}
histone2 = within(histone2, type<-factor(type, labels=c("training", "testing", "validating")))
histone2 = within(histone2, type<-factor(type, levels=c("training", "validating", "testing")))

histone3 = within(histone2, model<-factor(model))
histone3 = within(histone3, model<- factor(model, labels=c("Nguyen2D", "Nguyen2D+1D", "Zeng2", "Zeng3", "Zeng4")))

p2 = ggplot(histone3, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("CNN") + ylab("") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-dimension-layers-acc.pdf",height=12, width=9)
p2
dev.off()
```

Plots Motif data:
```{r}
motif2 = within(motif2, type<-factor(type, labels=c("training", "testing", "validating")))
motif2 = within(motif2, type<-factor(type, levels=c("training", "validating", "testing")))

motif3 = within(motif2, model<-factor(model))
motif3 = within(motif3, model<- factor(model, labels=c("Nguyen2D", "Nguyen2D+1D", "Zeng2", "Zeng3", "Zeng4")))

p3 = ggplot(motif3, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("CNN") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-dimension-layers-acc.pdf",height=12, width=9)
p3
dev.off()
```

### Plotting precision-recall

Reading the data:
```{r}
nguyen2dhistone = read.table("../cn/results/cnn_nguyen_2_conv2d-histone-pr.csv", header=TRUE, sep=",")
nguyen2dsplice = read.table("../cn/results/cnn_nguyen_2_conv2d-splice-pr.csv", header=TRUE, sep=",")
nguyen2dmotif = read.table("../cn/results/cnn_nguyen_2_conv2d-motif_discovery-pr.csv", header=TRUE, sep=",")
nguyen2dhistone$model = "CNN-Nguyen2D"
nguyen2dsplice$model = "CNN-Nguyen2D"
nguyen2dmotif$model = "CNN-Nguyen2D"

nguyen1dhistone = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-histone-pr.csv", header=TRUE, sep=",")
nguyen1dsplice = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-splice-pr.csv", header=TRUE, sep=",")
nguyen1dmotif = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-motif_discovery-pr.csv", header=TRUE, sep=",")
nguyen1dhistone$model = "CNN-Nguyen2D+1D"
nguyen1dsplice$model = "CNN-Nguyen2D+1D"
nguyen1dmotif$model = "CNN-Nguyen2D+1D"

zeng2histone = read.table("../cn/results/cnn_zeng_2_conv2d-histone-pr.csv", header=TRUE, sep=",")
zeng2splice = read.table("../cn/results/cnn_zeng_2_conv2d-splice-pr.csv", header=TRUE, sep=",")
zeng2motif = read.table("../cn/results/cnn_zeng_2_conv2d-motif_discovery-pr.csv", header=TRUE, sep=",")
zeng2histone$model = "CNN-Zeng2"
zeng2splice$model = "CNN-Zeng2"
zeng2motif$model = "CNN-Zeng2"

zeng3histone = read.table("../cn/results/cnn_zeng_3_conv2d-histone-pr.csv", header=TRUE, sep=",")
zeng3splice = read.table("../cn/results/cnn_zeng_3_conv2d-splice-pr.csv", header=TRUE, sep=",")
zeng3motif = read.table("../cn/results/cnn_zeng_3_conv2d-motif_discovery-pr.csv", header=TRUE, sep=",")
zeng3histone$model = "CNN-Zeng3"
zeng3splice$model = "CNN-Zeng3"
zeng3motif$model = "CNN-Zeng3"

zeng4histone = read.table("../cn/results/cnn_zeng_4_conv2d-histone-pr.csv", header=TRUE, sep=",")
zeng4splice = read.table("../cn/results/cnn_zeng_4_conv2d-splice-pr.csv", header=TRUE, sep=",")
zeng4motif = read.table("../cn/results/cnn_zeng_4_conv2d-motif_discovery-pr.csv", header=TRUE, sep=",")
zeng4histone$model = "CNN-Zeng4"
zeng4splice$model = "CNN-Zeng4"
zeng4motif$model = "CNN-Zeng4"


## Appending all data
histone = rbind(nguyen2dhistone, nguyen1dhistone, zeng2histone, zeng3histone, zeng4histone)
str(histone)

splice = rbind(nguyen2dsplice, nguyen1dsplice, zeng2splice, zeng3splice, zeng4splice)
str(splice)

motif = rbind(nguyen2dmotif, nguyen1dmotif, zeng2motif, zeng3motif, zeng4motif)
str(motif)
```

Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
p = ggplot(splice, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-dimension-layers-pr.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-dimension-layers-pr.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$precision)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

p3 = ggplot(motif2, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.0)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-dimension-layers-pr.pdf",height=7, width=9)
p3
dev.off()
```

### Plotting ROC curves

Reading the data:
```{r}
nguyen2dhistone = read.table("../cn/results/cnn_nguyen_2_conv2d-histone-roc.csv", header=TRUE, sep=",")
nguyen2dsplice = read.table("../cn/results/cnn_nguyen_2_conv2d-splice-roc.csv", header=TRUE, sep=",")
nguyen2dmotif = read.table("../cn/results/cnn_nguyen_2_conv2d-motif_discovery-roc.csv", header=TRUE, sep=",")
nguyen2dhistone$model = "CNN-Nguyen2D"
nguyen2dsplice$model = "CNN-Nguyen2D"
nguyen2dmotif$model = "CNN-Nguyen2D"

nguyen1dhistone = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-histone-roc.csv", header=TRUE, sep=",")
nguyen1dsplice = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-splice-roc.csv", header=TRUE, sep=",")
nguyen1dmotif = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-motif_discovery-roc.csv", header=TRUE, sep=",")
nguyen1dhistone$model = "CNN-Nguyen2D+1D"
nguyen1dsplice$model = "CNN-Nguyen2D+1D"
nguyen1dmotif$model = "CNN-Nguyen2D+1D"

zeng2histone = read.table("../cn/results/cnn_zeng_2_conv2d-histone-roc.csv", header=TRUE, sep=",")
zeng2splice = read.table("../cn/results/cnn_zeng_2_conv2d-splice-roc.csv", header=TRUE, sep=",")
zeng2motif = read.table("../cn/results/cnn_zeng_2_conv2d-motif_discovery-roc.csv", header=TRUE, sep=",")
zeng2histone$model = "CNN-Zeng2"
zeng2splice$model = "CNN-Zeng2"
zeng2motif$model = "CNN-Zeng2"

zeng3histone = read.table("../cn/results/cnn_zeng_3_conv2d-histone-roc.csv", header=TRUE, sep=",")
zeng3splice = read.table("../cn/results/cnn_zeng_3_conv2d-splice-roc.csv", header=TRUE, sep=",")
zeng3motif = read.table("../cn/results/cnn_zeng_3_conv2d-motif_discovery-roc.csv", header=TRUE, sep=",")
zeng3histone$model = "CNN-Zeng3"
zeng3splice$model = "CNN-Zeng3"
zeng3motif$model = "CNN-Zeng3"

zeng4histone = read.table("../cn/results/cnn_zeng_4_conv2d-histone-roc.csv", header=TRUE, sep=",")
zeng4splice = read.table("../cn/results/cnn_zeng_4_conv2d-splice-roc.csv", header=TRUE, sep=",")
zeng4motif = read.table("../cn/results/cnn_zeng_4_conv2d-motif_discovery-roc.csv", header=TRUE, sep=",")
zeng4histone$model = "CNN-Zeng4"
zeng4splice$model = "CNN-Zeng4"
zeng4motif$model = "CNN-Zeng4"


## Appending all data
histone = rbind(nguyen2dhistone, nguyen1dhistone, zeng2histone, zeng3histone, zeng4histone)
str(histone)

splice = rbind(nguyen2dsplice, nguyen1dsplice, zeng2splice, zeng3splice, zeng4splice)
str(splice)

motif = rbind(nguyen2dmotif, nguyen1dmotif, zeng2motif, zeng3motif, zeng4motif)
str(motif)
```
Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
p = ggplot(splice, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-dimension-layers-roc.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-dimension-layers-roc.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$fpr)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

p3 = ggplot(motif2, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.0)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-dimension-layers-roc.pdf",height=7, width=9)
p3
dev.off()
```




## Role of embedding

Models DeepRAM:
- CNN
- RNN
- CNN+RNN

### Plotting accuracy

Reading the data:
```{r}
## Splice
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-splice-accuracy.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-splice-accuracy.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-splice-accuracy.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-splice-accuracy.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-splice-accuracy.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-splice-accuracy.csv", header=TRUE, sep=",")

splice = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
splice2 = gather(splice, "type", "acc")
splice2$model = rep(c("DeepRAM-CNN-OneHot","DeepRAM-CNN-Embed","DeepRAM-RNN-OneHot","DeepRAM-RNN-Embed","DeepRAM-CNN-RNN-OneHot","DeepRAM-CNN-RNN-Embed"),3)
splice2

## Histone
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-histone-accuracy.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-histone-accuracy.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-histone-accuracy.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-histone-accuracy.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-histone-accuracy.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-histone-accuracy.csv", header=TRUE, sep=",")

histone = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
histone2 = gather(histone, "type", "acc")
histone2$model = rep(c("DeepRAM-CNN-OneHot","DeepRAM-CNN-Embed","DeepRAM-RNN-OneHot","DeepRAM-RNN-Embed","DeepRAM-CNN-RNN-OneHot","DeepRAM-CNN-RNN-Embed"),3)
histone2

## Motif
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-motif_discovery-accuracy.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-motif_discovery-accuracy.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-motif_discovery-accuracy.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-motif_discovery-accuracy.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-motif_discovery-accuracy.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-motif_discovery-accuracy.csv", header=TRUE, sep=",")

motif = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
motif2 = gather(motif, "type", "acc")
motif2$model = rep(c("DeepRAM-CNN-OneHot","DeepRAM-CNN-Embed","DeepRAM-RNN-OneHot","DeepRAM-RNN-Embed","DeepRAM-CNN-RNN-OneHot","DeepRAM-CNN-RNN-Embed"),3)
motif2

```

Plots Splice data:
```{r}
splice2 = within(splice2, type<-factor(type, labels=c("training", "testing", "validating")))
splice2 = within(splice2, type<-factor(type, levels=c("training", "validating", "testing")))

splice3 = within(splice2, model<-factor(model))
splice3 = within(splice3, model<- factor(model, labels=c("CNN-Embed", "CNN-OneHot", "CNN-RNN-Embed", "CNN-RNN-OneHot", "RNN-Embed", "RNN-OneHot")))

p = ggplot(splice3, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("DeepRAM") + ylab("") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-embedding-acc.pdf",height=12, width=9)
p
dev.off()
```

Plots Histone data:
```{r}
histone2 = within(histone2, type<-factor(type, labels=c("training", "testing", "validating")))
histone2 = within(histone2, type<-factor(type, levels=c("training", "validating", "testing")))

histone3 = within(histone2, model<-factor(model))
histone3 = within(histone3, model<- factor(model, labels=c("CNN-Embed", "CNN-OneHot", "CNN-RNN-Embed", "CNN-RNN-OneHot", "RNN-Embed", "RNN-OneHot")))

p2 = ggplot(histone3, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("DeepRAM") + ylab("") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-embedding-acc.pdf",height=12, width=9)
p2
dev.off()
```

Plots Motif data:
```{r}
motif2 = within(motif2, type<-factor(type, labels=c("training", "testing", "validating")))
motif2 = within(motif2, type<-factor(type, levels=c("training", "validating", "testing")))

motif3 = within(motif2, model<-factor(model))
motif3 = within(motif3, model<- factor(model, labels=c("CNN-Embed", "CNN-OneHot", "CNN-RNN-Embed", "CNN-RNN-OneHot", "RNN-Embed", "RNN-OneHot")))

p3 = ggplot(motif3, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("DeepRAM") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-embedding-acc.pdf",height=12, width=9)
p3
dev.off()
```


### Plotting precision recall

Reading the data:
```{r}
## Splice
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-splice-pr.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-splice-pr.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-splice-pr.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-splice-pr.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-splice-pr.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-splice-pr.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

splice = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(splice)

## Histone
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-histone-pr.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-histone-pr.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-histone-pr.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-histone-pr.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-histone-pr.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-histone-pr.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

histone = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(histone)

## Motif
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-motif_discovery-pr.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-motif_discovery-pr.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-motif_discovery-pr.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-motif_discovery-pr.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-motif_discovery-pr.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-motif_discovery-pr.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

motif = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(motif)
```

Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
p = ggplot(splice, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-embedding-pr.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-embedding-pr.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$precision)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

p3 = ggplot(motif2, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.8)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-embedding-pr.pdf",height=7, width=9)
p3
dev.off()
```


### Plotting ROC

Reading the data:
```{r}
## Splice
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-splice-roc.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-splice-roc.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-splice-roc.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-splice-roc.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-splice-roc.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-splice-roc.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

splice = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(splice)

## Histone
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-histone-roc.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-histone-roc.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-histone-roc.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-histone-roc.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-histone-roc.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-histone-roc.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

histone = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(histone)

## Motif
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-motif_discovery-roc.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-motif_discovery-roc.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-motif_discovery-roc.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-motif_discovery-roc.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-motif_discovery-roc.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-motif_discovery-roc.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

motif = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(motif)
```

Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
p = ggplot(splice, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-embedding-roc.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-embedding-roc.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$fpr)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

p3 = ggplot(motif2, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.0)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-embedding-roc.pdf",height=7, width=9)
p3
dev.off()
```

## Accuracy plots for all NLP models

All accuracies for NLP models are saved in `data-description.csv`.

### The role of optimizer
Reading data:
```{r}
nlp = read.table("../nlp/dataset-evaluation.csv", header=TRUE, sep=",")
str(nlp)

nlp2 = subset(nlp, select = c("X","train_acc","val_acc","test_acc"))
str(nlp2)

splice = subset(nlp2, X %in% c("splice_baseline_sgd256", "splice_baseline_adam256"))
splice2 = subset(splice, select = c("train_acc","val_acc","test_acc"))
splice3 = gather(splice2, "type", "acc")
splice3$model = rep(c("SGD", "ADAM"),3)

histone = subset(nlp2, X %in% c("histone_baseline_sgd256", "histone_baseline_adam256"))
histone2 = subset(histone, select = c("train_acc","val_acc","test_acc"))
histone3 = gather(histone2, "type", "acc")
histone3$model = rep(c("SGD", "ADAM"),3)

discovery = subset(nlp2, X %in% c("discovery_baseline_sgd256", "discovery_baseline_adam256"))
discovery2 = subset(discovery, select = c("train_acc","val_acc","test_acc"))
discovery3 = gather(discovery2, "type", "acc")
discovery3$model = rep(c("SGD", "ADAM"),3)
```

Plots Splice data:
```{r}
splice3 = within(splice3, type <- factor(type))
splice4 = within(splice3, type<-factor(type, labels=c("testing", "training", "validating")))
splice4 = within(splice4, type<-factor(type, levels=c("training", "validating", "testing")))

p = ggplot(splice4, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("LSTM-layer") + ylab("") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-optimizer-acc.pdf",height=12, width=9)
p
dev.off()
```

Plots histone data:
```{r}
histone4 = within(histone3, type<-factor(type, labels=c("testing", "training", "validating")))
histone4 = within(histone4, type<-factor(type, levels=c("training", "validating", "testing")))

p2 = ggplot(histone4, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("LSTM-layer") + ylab("") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-optimizer-acc.pdf",height=12, width=9)
p2
dev.off()
```

Plots motif data:
```{r}
discovery4 = within(discovery3, type<-factor(type, labels=c("testing", "training", "validating")))
discovery4 = within(discovery4, type<-factor(type, levels=c("training", "validating", "testing")))

p3 = ggplot(discovery4, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("LSTM-layer") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-optimizer-acc.pdf",height=12, width=9)
p3
dev.off()
```

### The role of the embedding size
Reading data:
```{r}
nlp = read.table("../nlp/dataset-evaluation.csv", header=TRUE, sep=",")
str(nlp)

nlp2 = subset(nlp, select = c("X","train_acc","val_acc","test_acc"))
str(nlp2)

splice = subset(nlp2, X %in% c("splice_doc2vec_size50", "splice_doc2vec_size100", "splice_doc2vec_size150", "splice_doc2vec_size200"))
splice2 = subset(splice, select = c("train_acc","val_acc","test_acc"))
splice3 = gather(splice2, "type", "acc")
splice3$model = rep(c(50,100,150,200),3)

histone = subset(nlp2, X %in% c("histone_doc2vec_size50", "histone_doc2vec_size100", "histone_doc2vec_size150", "histone_doc2vec_size200"))
histone2 = subset(histone, select = c("train_acc","val_acc","test_acc"))
histone3 = gather(histone2, "type", "acc")
histone3$model = rep(c(50,100,150,200),3)

discovery = subset(nlp2, X %in% c("discovery_doc2vec_size50", "discovery_doc2vec_size100", "discovery_doc2vec_size150", "discovery_doc2vec_size200"))
discovery2 = subset(discovery, select = c("train_acc","val_acc","test_acc"))
discovery3 = gather(discovery2, "type", "acc")
discovery3$model = rep(c(50,100,150,200),3)
```

Plots Splice data:
```{r}
splice4 = within(splice3, type<-factor(type, labels=c("testing", "training", "validating")))
splice4 = within(splice4, type<-factor(type, levels=c("training", "validating", "testing")))

p = ggplot(splice4, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("embedding size \n doc2vec") + ylab("") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-embed-size-acc.pdf",height=12, width=9)
p
dev.off()
```

Plots histone data:
```{r}
histone4 = within(histone3, type<-factor(type, labels=c("testing", "training", "validating")))
histone4 = within(histone4, type<-factor(type, levels=c("training", "validating", "testing")))

p2 = ggplot(histone4, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("embedding size \n doc2vec") + ylab("") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-embed-size-acc.pdf",height=12, width=9)
p2
dev.off()
```

Plots motif data:
```{r}
discovery4 = within(discovery3, type<-factor(type, labels=c("testing", "training", "validating")))
discovery4 = within(discovery4, type<-factor(type, levels=c("training", "validating", "testing")))

p3 = ggplot(discovery4, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("embedding size \n doc2vec") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-embed-size-acc.pdf",height=12, width=9)
p3
dev.off()
```

### The role of the batch size
Reading data:
```{r}
nlp = read.table("../nlp/dataset-evaluation.csv", header=TRUE, sep=",")
str(nlp)

nlp2 = subset(nlp, select = c("X","train_acc","val_acc","test_acc"))
str(nlp2)

splice = subset(nlp2, X %in% c("splice_ae_adam32", "splice_ae_adam256", "splice_ae_adam1024"))
splice2 = subset(splice, select = c("train_acc","val_acc","test_acc"))
splice3 = gather(splice2, "type", "acc")
splice3$model = rep(c(32, 256, 1024),3)

histone = subset(nlp2, X %in% c("histone_ae_adam32", "histone_ae_adam256", "histone_ae_adam1024"))
histone2 = subset(histone, select = c("train_acc","val_acc","test_acc"))
histone3 = gather(histone2, "type", "acc")
histone3$model = rep(c(32, 256, 1024),3)

discovery = subset(nlp2, X %in% c("discovery_ae_adam32", "discovery_ae_adam256", "discovery_ae_adam1024"))
discovery2 = subset(discovery, select = c("train_acc","val_acc","test_acc"))
discovery3 = gather(discovery2, "type", "acc")
discovery3$model = rep(c(32, 256, 1024),3)
```

Plots Splice data:
```{r}
splice4 = within(splice3, type<-factor(type, labels=c("testing", "training", "validating")))
splice4 = within(splice4, type<-factor(type, levels=c("training", "validating", "testing")))

p = ggplot(splice4, aes(x=as.factor(model), y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("batch size \n LSTM-AE") + ylab("") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-batch-size-acc.pdf",height=12, width=9)
p
dev.off()
```

Plots histone data:
```{r}
histone4 = within(histone3, type<-factor(type, labels=c("testing", "training", "validating")))
histone4 = within(histone4, type<-factor(type, levels=c("training", "validating", "testing")))

p2 = ggplot(histone4, aes(x=as.factor(model), y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("batch size \n LSTM-AE") + ylab("") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-batch-size-acc.pdf",height=12, width=9)
p2
dev.off()
```

Plots motif data:
```{r}
discovery4 = within(discovery3, type<-factor(type, labels=c("testing", "training", "validating")))
discovery4 = within(discovery4, type<-factor(type, levels=c("training", "validating", "testing")))

p3 = ggplot(discovery4, aes(x=as.factor(model), y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("batch size \n LSTM-AE") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-batch-size-acc.pdf",height=12, width=9)
p3
dev.off()
```


## The role of optimizer

### Plotting precision recall

Reading data:
```{r}
splice1 = read.table("../nlp/splice/uci_baseline_adam256_test_pr.csv", header=TRUE, sep=",")
splice1$model = "LSTM-layer-ADAM"

splice2 = read.table("../nlp/splice/uci_baseline_sgd256_test_pr.csv", header=TRUE, sep=",")
splice2$model = "LSTM-layer-SGD"

splice=rbind(splice1,splice2)


histone1 = read.table("../nlp/histone/baseline_histone_adam256_test_pr.csv", header=TRUE, sep=",")
histone1$model = "LSTM-layer-ADAM"

histone2 = read.table("../nlp/histone/baseline_histone_sgd256_test_pr.csv", header=TRUE, sep=",")
histone2$model = "LSTM-layer-SGD"

histone=rbind(histone1,histone2)

motif1 = read.table("../nlp/motif-discovery/discovery_baseline_adam256_test_pr.csv", header=TRUE, sep=",")
motif1$model = "LSTM-layer-ADAM"

motif2 = read.table("../nlp/motif-discovery/discovery_baseline_sgd256_test_pr.csv", header=TRUE, sep=",")
motif2$model = "LSTM-layer-SGD"

motif=rbind(motif1,motif2)

str(splice)
str(histone)
str(motif)
```


Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
p = ggplot(splice, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="Paired") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-optimizer-pr.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="Paired") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-optimizer-pr.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$precision)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

p3 = ggplot(motif2, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="Paired") +
  xlab("Recall") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.8)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-optimizer-pr.pdf",height=7, width=9)
p3
dev.off()
```

### Plotting ROC

Reading data:
```{r}
splice1 = read.table("../nlp/splice/uci_baseline_adam256_test_roc.csv", header=TRUE, sep=",")
splice1$model = "LSTM-layer-ADAM"

splice2 = read.table("../nlp/splice/uci_baseline_sgd256_test_roc.csv", header=TRUE, sep=",")
splice2$model = "LSTM-layer-SGD"

splice=rbind(splice1,splice2)


histone1 = read.table("../nlp/histone/baseline_histone_adam256_test_roc.csv", header=TRUE, sep=",")
histone1$model = "LSTM-layer-ADAM"

histone2 = read.table("../nlp/histone/baseline_histone_sgd256_test_roc.csv", header=TRUE, sep=",")
histone2$model = "LSTM-layer-SGD"

histone=rbind(histone1,histone2)

motif1 = read.table("../nlp/motif-discovery/discovery_baseline_adam256_test_roc.csv", header=TRUE, sep=",")
motif1$model = "LSTM-layer-ADAM"

motif2 = read.table("../nlp/motif-discovery/discovery_baseline_sgd256_test_roc.csv", header=TRUE, sep=",")
motif2$model = "LSTM-layer-SGD"

motif=rbind(motif1,motif2)

str(splice)
str(histone)
str(motif)
```

Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
p = ggplot(splice, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="Paired") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-optimizer-roc.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="Paired") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-optimizer-roc.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$fpr)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

p3 = ggplot(motif2, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="Paired") +
  xlab("False Positive Rate") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.0)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-optimizer-roc.pdf",height=7, width=9)
p3
dev.off()
```

## The role of embedding size

### Plotting precision recall

Reading data:
```{r}
splice1 = read.table("../nlp/splice/uci_doc2vec_size50_test_pr.csv", header=TRUE, sep=",")
splice1$model = "doc2vec-size50"

splice2 = read.table("../nlp/splice/uci_doc2vec_size100_test_pr.csv", header=TRUE, sep=",")
splice2$model = "doc2vec-size100"

splice3 = read.table("../nlp/splice/uci_doc2vec_size150_test_pr.csv", header=TRUE, sep=",")
splice3$model = "doc2vec-size150"

splice4 = read.table("../nlp/splice/uci_doc2vec_size200_test_pr.csv", header=TRUE, sep=",")
splice4$model = "doc2vec-size200"

splice=rbind(splice1,splice2,splice3,splice4)


histone1 = read.table("../nlp/histone/doc2vec_histone_size50_test_pr.csv", header=TRUE, sep=",")
histone1$model = "doc2vec-size50"

histone2 = read.table("../nlp/histone/doc2vec_histone_size100_test_pr.csv", header=TRUE, sep=",")
histone2$model = "doc2vec-size100"

histone3 = read.table("../nlp/histone/doc2vec_histone_size150_test_pr.csv", header=TRUE, sep=",")
histone3$model = "doc2vec-size150"

histone4 = read.table("../nlp/histone/doc2vec_histone_size200_test_pr.csv", header=TRUE, sep=",")
histone4$model = "doc2vec-size200"

histone=rbind(histone1,histone2, histone3, histone4)



motif1 = read.table("../nlp/motif-discovery/discovery_doc2vec_size50test_pr.csv", header=TRUE, sep=",")
motif1$model = "doc2vec-size50"

motif2 = read.table("../nlp/motif-discovery/discovery_doc2vec_size100test_pr.csv", header=TRUE, sep=",")
motif2$model = "doc2vec-size100"

motif3 = read.table("../nlp/motif-discovery/discovery_doc2vec_size150test_pr.csv", header=TRUE, sep=",")
motif3$model = "doc2vec-size150"

motif4 = read.table("../nlp/motif-discovery/discovery_doc2vec_size200test_pr.csv", header=TRUE, sep=",")
motif4$model = "doc2vec-size200"


motif=rbind(motif1,motif2, motif3, motif4)

str(splice)
str(histone)
str(motif)
```


Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
splice = within(splice, model<-factor(model))
splice = within(splice, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))

p = ggplot(splice, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-embed-size-pr.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}
histone = within(histone, model<-factor(model))
histone = within(histone, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))

p2 = ggplot(histone, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-embed-size-pr.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$precision)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

motif3 = within(motif2, model<-factor(model))
motif3 = within(motif3, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))

p3 = ggplot(motif3, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.8)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-embed-size-pr.pdf",height=7, width=9)
p3
dev.off()
```

#### Strange behavior of histone data
We got straight lines in the testing PR curves, so we will compare with the training:
```{r}
histone1 = read.table("../nlp/histone/doc2vec_histone_size50_train_pr.csv", header=TRUE, sep=",")
histone1$model = "doc2vec-size50"

histone2 = read.table("../nlp/histone/doc2vec_histone_size100_train_pr.csv", header=TRUE, sep=",")
histone2$model = "doc2vec-size100"

histone3 = read.table("../nlp/histone/doc2vec_histone_size150_train_pr.csv", header=TRUE, sep=",")
histone3$model = "doc2vec-size150"

histone4 = read.table("../nlp/histone/doc2vec_histone_size200_train_pr.csv", header=TRUE, sep=",")
histone4$model = "doc2vec-size200"

histone=rbind(histone1,histone2, histone3, histone4)

### Plot
histone = within(histone, model<-factor(model))
histone = within(histone, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))

p2 = ggplot(histone, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
#    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )
p2
```
Same straight lines!

### Plotting ROC

Reading data:
```{r}
splice1 = read.table("../nlp/splice/uci_doc2vec_size50_test_roc.csv", header=TRUE, sep=",")
splice1$model = "doc2vec-size50"

splice2 = read.table("../nlp/splice/uci_doc2vec_size100_test_roc.csv", header=TRUE, sep=",")
splice2$model = "doc2vec-size100"

splice3 = read.table("../nlp/splice/uci_doc2vec_size150_test_roc.csv", header=TRUE, sep=",")
splice3$model = "doc2vec-size150"

splice4 = read.table("../nlp/splice/uci_doc2vec_size200_test_roc.csv", header=TRUE, sep=",")
splice4$model = "doc2vec-size200"

splice=rbind(splice1,splice2,splice3,splice4)


histone1 = read.table("../nlp/histone/doc2vec_histone_size50_test_roc.csv", header=TRUE, sep=",")
histone1$model = "doc2vec-size50"

histone2 = read.table("../nlp/histone/doc2vec_histone_size100_test_roc.csv", header=TRUE, sep=",")
histone2$model = "doc2vec-size100"

histone3 = read.table("../nlp/histone/doc2vec_histone_size150_test_roc.csv", header=TRUE, sep=",")
histone3$model = "doc2vec-size150"

histone4 = read.table("../nlp/histone/doc2vec_histone_size200_test_roc.csv", header=TRUE, sep=",")
histone4$model = "doc2vec-size200"

histone=rbind(histone1,histone2, histone3, histone4)



motif1 = read.table("../nlp/motif-discovery/discovery_doc2vec_size50test_roc.csv", header=TRUE, sep=",")
motif1$model = "doc2vec-size50"

motif2 = read.table("../nlp/motif-discovery/discovery_doc2vec_size100test_roc.csv", header=TRUE, sep=",")
motif2$model = "doc2vec-size100"

motif3 = read.table("../nlp/motif-discovery/discovery_doc2vec_size150test_roc.csv", header=TRUE, sep=",")
motif3$model = "doc2vec-size150"

motif4 = read.table("../nlp/motif-discovery/discovery_doc2vec_size200test_roc.csv", header=TRUE, sep=",")
motif4$model = "doc2vec-size200"

motif=rbind(motif1,motif2, motif3, motif4)

str(splice)
str(histone)
str(motif)
```

Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
splice = within(splice, model<-factor(model))
splice = within(splice, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))

p = ggplot(splice, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-embed-size-roc.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}

histone = within(histone, model<-factor(model))
histone = within(histone, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))

p2 = ggplot(histone, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-embed-size-roc.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$fpr)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

motif3 = within(motif2, model<-factor(model))
motif3 = within(motif3, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))

p3 = ggplot(motif3, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.0)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-embed-size-roc.pdf",height=7, width=9)
p3
dev.off()
```

## The role of batch size

### Plotting precision recall

Reading data:
```{r}
splice1 = read.table("../nlp/splice/uci_ae_adam32_test_pr.csv", header=TRUE, sep=",")
splice1$model = "LSTM-AE-size32"

splice2 = read.table("../nlp/splice/uci_ae_adam256_test_pr.csv", header=TRUE, sep=",")
splice2$model = "LSTM-AE-size256"

splice3 = read.table("../nlp/splice/uci_ae_adam1024_test_pr.csv", header=TRUE, sep=",")
splice3$model = "LSTM-AE-size1024"

splice=rbind(splice1,splice2,splice3)


histone1 = read.table("../nlp/histone/ae_histone_adam32_test_pr.csv", header=TRUE, sep=",")
histone1$model = "LSTM-AE-size32"

histone2 = read.table("../nlp/histone/ae_histone_adam256_test_pr.csv", header=TRUE, sep=",")
histone2$model = "LSTM-AE-size256"

histone3 = read.table("../nlp/histone/ae_histone_adam1024_test_pr.csv", header=TRUE, sep=",")
histone3$model = "LSTM-AE-size1024"

histone=rbind(histone1,histone2, histone3)



motif1 = read.table("../nlp/motif-discovery/discovery_ae_adam32_test_pr.csv", header=TRUE, sep=",")
motif1$model = "LSTM-AE-size32"

motif2 = read.table("../nlp/motif-discovery/discovery_ae_adam256_test_pr.csv", header=TRUE, sep=",")
motif2$model = "LSTM-AE-size256"

motif3 = read.table("../nlp/motif-discovery/discovery_ae_adam1024_test_pr.csv", header=TRUE, sep=",")
motif3$model = "LSTM-AE-size1024"

motif=rbind(motif1,motif2, motif3)

str(splice)
str(histone)
str(motif)
```

Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
splice = within(splice, model<-factor(model))
splice = within(splice, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))

p = ggplot(splice, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-batch-size-pr.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}
histone = within(histone, model<-factor(model))
histone = within(histone, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))

p2 = ggplot(histone, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("Precision") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-batch-size-pr.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$precision)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

motif3 = within(motif2, model<-factor(model))
motif3 = within(motif3, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))

p3 = ggplot(motif3, aes(x=recall, y=precision, color=model)) +
  geom_line(size=1) +
  ylim(c(0.5,1)) +
  geom_hline(yintercept=0.5, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("Recall") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.8)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-batch-size-pr.pdf",height=7, width=9)
p3
dev.off()
```

### Plotting ROC

Reading data:
```{r}
splice1 = read.table("../nlp/splice/uci_ae_adam32_test_roc.csv", header=TRUE, sep=",")
splice1$model = "LSTM-AE-size32"

splice2 = read.table("../nlp/splice/uci_ae_adam256_test_roc.csv", header=TRUE, sep=",")
splice2$model = "LSTM-AE-size256"

splice3 = read.table("../nlp/splice/uci_ae_adam1024_test_roc.csv", header=TRUE, sep=",")
splice3$model = "LSTM-AE-size1024"

splice=rbind(splice1,splice2,splice3)


histone1 = read.table("../nlp/histone/ae_histone_adam32_test_roc.csv", header=TRUE, sep=",")
histone1$model = "LSTM-AE-size32"

histone2 = read.table("../nlp/histone/ae_histone_adam256_test_roc.csv", header=TRUE, sep=",")
histone2$model = "LSTM-AE-size256"

histone3 = read.table("../nlp/histone/ae_histone_adam1024_test_roc.csv", header=TRUE, sep=",")
histone3$model = "LSTM-AE-size1024"

histone=rbind(histone1,histone2, histone3)



motif1 = read.table("../nlp/motif-discovery/discovery_ae_adam32_test_roc.csv", header=TRUE, sep=",")
motif1$model = "LSTM-AE-size32"

motif2 = read.table("../nlp/motif-discovery/discovery_ae_adam256_test_roc.csv", header=TRUE, sep=",")
motif2$model = "LSTM-AE-size256"

motif3 = read.table("../nlp/motif-discovery/discovery_ae_adam1024_test_roc.csv", header=TRUE, sep=",")
motif3$model = "LSTM-AE-size1024"

motif=rbind(motif1,motif2, motif3)

str(splice)
str(histone)
str(motif)
```

Plotting Splice data:
```{r}
## Note that splice data has three levels, so ovr=0 means that one class is 0 and 1,2 are the other class
splice = within(splice, model<-factor(model))
splice = within(splice, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))

p = ggplot(splice, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) + facet_wrap(~as.factor(ovr)) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.6)),
    axis.title.x = element_text(size=rel(2.0)),
    axis.title.y = element_text(size=rel(2.0), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-batch-size-roc.pdf",height=7, width=13)
p
dev.off()
```

Plotting Histone data:
```{r}

histone = within(histone, model<-factor(model))
histone = within(histone, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))

p2 = ggplot(histone, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("True Positive Rate") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), 
    legend.title=element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-batch-size-roc.pdf",height=7, width=5.5)
p2
dev.off()
```

Plotting Motif data:
```{r}
## Motif data is very large, so we will randomly select rows to plot
str(motif)
n = length(motif$fpr)
k = floor(n/10)
motif2 = motif[sample(nrow(motif), k), ]

motif3 = within(motif2, model<-factor(model))
motif3 = within(motif3, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))

p3 = ggplot(motif3, aes(x=fpr, y=tpr, color=model)) +
  geom_line(size=1) +
  geom_abline(slope=1, linetype = "dashed") +
  #scale_color_manual(values = cbp1) +
  scale_color_brewer(palette="YlGnBu") +
  xlab("False Positive Rate") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(2.8)),
    axis.title.x = element_text(size=rel(2.2)),
    axis.title.y = element_text(size=rel(2.2), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(2.2), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(2.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.0)), 
    legend.title=element_blank(),
    #legend.position = "none",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-batch-size-roc.pdf",height=7, width=9)
p3
dev.off()
```


## Overall comparison
Comparing the best models.

### Plotting accuracy
Reading results for all models for splice data:
```{r}
## NLP models
nlp = read.table("../nlp/dataset-evaluation.csv", header=TRUE, sep=",")
str(nlp)
nlp2 = subset(nlp, select = c("X","train_acc","val_acc","test_acc"))
str(nlp2)

splice = nlp2[grep("splice", nlp2$X),]
lstmlayer = subset(splice, test_acc == max(splice[grep("baseline",splice$X),]$test_acc))
lstmae = subset(splice, test_acc == max(splice[grep("ae",splice$X),]$test_acc))
doc2vec = subset(splice, test_acc == max(splice[grep("doc2vec",splice$X),]$test_acc))

## CNN models
cnn = read.table("../cn/data-evaluation.csv", header=TRUE, sep=",")
str(cnn)

splice = subset(cnn,data=="splice")
nguyen = subset(splice, test_accuracy == max(splice[grep("nguyen",splice$model),]$test_accuracy))
zeng = subset(splice, test_accuracy == max(splice[grep("zeng",splice$model),]$test_accuracy))
deepram = subset(splice, test_accuracy == max(splice[grep("deepram",splice$model),]$test_accuracy))
deepdbp = subset(splice, test_accuracy == max(splice[grep("deepdbp",splice$model),]$test_accuracy))

nguyen$data = NULL
zeng$data = NULL
deepram$data = NULL
deepdbp$data = NULL

splice.cnn = rbind(nguyen, zeng, deepram, deepdbp)
splice.nlp = rbind(lstmlayer, lstmae, doc2vec)
names(splice.nlp) = c("model", "accuracy", "val_accuracy", "test_accuracy")

splice = rbind(splice.nlp, splice.cnn)
splice$model = NULL
splice2 = gather(splice, "type", "acc")
splice2$model = rep(c("LSTM-layer", "LSTM-AE", "doc2vec", "CNN-Nguyen", "CNN-Zeng", "DeepRAM", "DeepDBP"),3)
```

Plots Splice data:
```{r}
splice2 = within(splice2, type <- factor(type))
splice2 = within(splice2, type<-factor(type, labels=c("training", "testing", "validating")))
splice2 = within(splice2, type<-factor(type, levels=c("training", "validating", "testing")))

p = ggplot(splice2, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("") + ylab("") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-best-acc.pdf",height=12, width=9)
p
dev.off()
```

Reading results for all models for histone data:
```{r}
## NLP models
nlp = read.table("../nlp/dataset-evaluation.csv", header=TRUE, sep=",")
str(nlp)
nlp2 = subset(nlp, select = c("X","train_acc","val_acc","test_acc"))
str(nlp2)

histone = nlp2[grep("histone", nlp2$X),]
lstmlayer = subset(histone, test_acc == max(histone[grep("baseline",histone$X),]$test_acc))
lstmae = subset(histone, test_acc == max(histone[grep("ae",histone$X),]$test_acc))
doc2vec = subset(histone, test_acc == max(histone[grep("doc2vec",histone$X),]$test_acc))

## CNN models
cnn = read.table("../cn/data-evaluation.csv", header=TRUE, sep=",")
str(cnn)

histone = subset(cnn,data=="histone")

nguyen0 = histone[grep("nguyen",histone$model),]
nguyen = subset(nguyen0, test_accuracy == max(nguyen0$test_accuracy))
zeng0 = histone[grep("zeng",histone$model),]
zeng = subset(zeng0, test_accuracy == max(zeng0$test_accuracy))
deepram = subset(histone, test_accuracy == max(histone[grep("deepram",histone$model),]$test_accuracy))
deepdbp = subset(histone, test_accuracy == max(histone[grep("deepdbp",histone$model),]$test_accuracy))

nguyen$data = NULL
zeng$data = NULL
deepram$data = NULL
deepdbp$data = NULL

histone.cnn = rbind(nguyen, zeng, deepram, deepdbp)
histone.nlp = rbind(lstmlayer, lstmae, doc2vec)
names(histone.nlp) = c("model", "accuracy", "val_accuracy", "test_accuracy")

histone = rbind(histone.nlp, histone.cnn)
histone$model = NULL
histone2 = gather(histone, "type", "acc")
histone2$model = rep(c("LSTM-layer", "LSTM-AE", "doc2vec", "CNN-Nguyen", "CNN-Zeng", "DeepRAM", "DeepDBP"),3)
```

Plots Histone data:
```{r}
histone2 = within(histone2, type<-factor(type, labels=c("training", "testing", "validating")))
histone2 = within(histone2, type<-factor(type, levels=c("training", "validating", "testing")))

p2 = ggplot(histone2, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("") + ylab("") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-best-acc.pdf",height=12, width=9)
p2
dev.off()
```

Reading results for all models for motif data:
```{r}
## NLP models
nlp = read.table("../nlp/dataset-evaluation.csv", header=TRUE, sep=",")
str(nlp)
nlp2 = subset(nlp, select = c("X","train_acc","val_acc","test_acc"))
str(nlp2)

motif = nlp2[grep("discovery", nlp2$X),]
lstmlayer = subset(motif, test_acc == max(motif[grep("baseline",motif$X),]$test_acc))
lstmae = subset(motif, test_acc == max(motif[grep("ae",motif$X),]$test_acc))
doc2vec = subset(motif, test_acc == max(motif[grep("doc2vec",motif$X),]$test_acc))

## CNN models
cnn = read.table("../cn/data-evaluation.csv", header=TRUE, sep=",")
str(cnn)

motif = subset(cnn,data=="motif_discovery")

nguyen0 = motif[grep("nguyen",motif$model),]
nguyen = subset(nguyen0, test_accuracy == max(nguyen0$test_accuracy))
zeng0 = motif[grep("zeng",motif$model),]
zeng = subset(zeng0, test_accuracy == max(zeng0$test_accuracy))
deepram = subset(motif, test_accuracy == max(motif[grep("deepram",motif$model),]$test_accuracy))
deepdbp = subset(motif, test_accuracy == max(motif[grep("deepdbp",motif$model),]$test_accuracy))

nguyen$data = NULL
zeng$data = NULL
deepram$data = NULL
deepdbp$data = NULL

motif.cnn = rbind(nguyen, zeng, deepram, deepdbp)
motif.nlp = rbind(lstmlayer, lstmae, doc2vec)
names(motif.nlp) = c("model", "accuracy", "val_accuracy", "test_accuracy")

motif = rbind(motif.nlp, motif.cnn)
motif$model = NULL
motif2 = gather(motif, "type", "acc")
motif2$model = rep(c("LSTM-layer", "LSTM-AE", "doc2vec", "CNN-Nguyen", "CNN-Zeng", "DeepRAM", "DeepDBP"),3)
```

Plots Motif data:
```{r}
motif2 = within(motif2, type<-factor(type, labels=c("training", "testing", "validating")))
motif2 = within(motif2, type<-factor(type, levels=c("training", "validating", "testing")))


p3 = ggplot(motif2, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(3.0)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(2.6)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-best-acc.pdf",height=12, width=9)
p3
dev.off()
```

# Appendix

## The effect of regularization

### Accuracy

Reading data:
```{r}
zeng4histone = read.table("../cn/results/cnn_zeng_4_conv2d-histone-accuracy.csv", header=TRUE, sep=",")
zeng4splice = read.table("../cn/results/cnn_zeng_4_conv2d-splice-accuracy.csv", header=TRUE, sep=",")
zeng4motif = read.table("../cn/results/cnn_zeng_4_conv2d-motif_discovery-accuracy.csv", header=TRUE, sep=",")

zeng4histone.l2 = read.table("../cn/results/cnn_zeng_4_conv2d_l2-histone-accuracy.csv", header=TRUE, sep=",")
zeng4splice.l2 = read.table("../cn/results/cnn_zeng_4_conv2d_l2-splice-accuracy.csv", header=TRUE, sep=",")
zeng4motif.l2 = read.table("../cn/results/cnn_zeng_4_conv2d_l2-motif_discovery-accuracy.csv", header=TRUE, sep=",")

## Appending all data
histone = rbind(zeng4histone, zeng4histone)
histone2 = gather(histone, "type", "acc")
histone2$model = rep(c("No-reg", "L2-reg"),3)
histone2

splice = rbind(zeng4splice, zeng4splice.l2)
splice2 = gather(splice, "type", "acc")
splice2$model = rep(c("No-reg", "L2-reg"),3)
splice2

motif = rbind(zeng4motif, zeng4motif.l2)
motif2 = gather(motif, "type", "acc")
motif2$model = rep(c("No-reg", "L2-reg"),3)
motif2

```

Plots Splice data:
```{r}
splice2 = within(splice2, type<-factor(type, labels=c("training", "testing", "validating")))
splice2 = within(splice2, type<-factor(type, levels=c("training", "validating", "testing")))
splice2 = within(splice2, model<-factor(model, levels=c("No-reg", "L2-reg")))

p = ggplot(splice2, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("") + ylab("") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(3.5)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-l2-acc.pdf",height=12, width=9)
p
dev.off()
```

Plots Histone data:
```{r}
histone2 = within(histone2, type<-factor(type, labels=c("training", "testing", "validating")))
histone2 = within(histone2, type<-factor(type, levels=c("training", "validating", "testing")))
histone2 = within(histone2, model<-factor(model, levels=c("No-reg", "L2-reg")))

p2 = ggplot(histone2, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("") + ylab("") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(3.5)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-l2-acc.pdf",height=12, width=9)
p2
dev.off()
```

Plots Motif data:
```{r}
motif2 = within(motif2, type<-factor(type, labels=c("training", "testing", "validating")))
motif2 = within(motif2, type<-factor(type, levels=c("training", "validating", "testing")))
motif2 = within(motif2, model<-factor(model, levels=c("No-reg", "L2-reg")))

p3 = ggplot(motif2, aes(x=model, y=acc, fill=type)) +
  geom_bar(position="dodge", stat="identity") +
  scale_y_continuous(limits=c(0.5,1),oob = rescale_none) +
  #scale_fill_manual(values = cbp1)
  #scale_fill_viridis(discrete=TRUE)
  #scale_fill_brewer(palette="PuBu")
  scale_fill_brewer(palette="Blues") +
  xlab("") + ylab("") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(3.8)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey49", size=rel(3.0), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey49", size=rel(2.6), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(3.5)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-l2-acc.pdf",height=12, width=9)
p3
dev.off()
```

### Learning dynamics

Reading the data:
```{r}
zeng4histone = read.table("../cn/results/cnn_zeng_4_conv2d-histone-dynamics.csv", header=TRUE, sep=",")
zeng4splice = read.table("../cn/results/cnn_zeng_4_conv2d-splice-dynamics.csv", header=TRUE, sep=",")
zeng4motif = read.table("../cn/results/cnn_zeng_4_conv2d-motif_discovery-dynamics.csv", header=TRUE, sep=",")
zeng4histone$model = "No-reg"
zeng4splice$model = "No-reg"
zeng4motif$model = "No-reg"

zeng4histone.l2 = read.table("../cn/results/cnn_zeng_4_conv2d_l2-histone-dynamics.csv", header=TRUE, sep=",")
zeng4splice.l2 = read.table("../cn/results/cnn_zeng_4_conv2d_l2-splice-dynamics.csv", header=TRUE, sep=",")
zeng4motif.l2 = read.table("../cn/results/cnn_zeng_4_conv2d_l2-motif_discovery-dynamics.csv", header=TRUE, sep=",")
zeng4histone.l2$model = "L2-reg"
zeng4splice.l2$model = "L2-reg"
zeng4motif.l2$model = "L2-reg"

## Appending all data
histone = rbind(zeng4histone, zeng4histone.l2)
str(histone)

splice = rbind(zeng4splice, zeng4splice.l2)
str(splice)

motif = rbind(zeng4motif, zeng4motif.l2)
str(motif)
```
Plotting Splice data:
```{r}
p = ggplot(splice, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="Paired") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl = ggplot(splice, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="Paired") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-l2-dynamics.pdf",height=6, width=7)
p
dev.off()

pdf("splice-l2-dynamics-loss.pdf",height=6, width=7)
pl
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="Paired") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl2 = ggplot(histone, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="Paired") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-l2-dynamics.pdf",height=6, width=7)
p2
dev.off()

pdf("histone-l2-dynamics-loss.pdf",height=6, width=7)
pl2
dev.off()
```

Plotting Motif data:
```{r}
p3 = ggplot(motif, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="Paired") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl3 = ggplot(motif, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="Paired") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-l2-dynamics.pdf",height=6, width=7)
p3
dev.off()

pdf("motif-l2-dynamics-loss.pdf",height=6, width=7)
pl3
dev.off()
```

## Learning dynamics for SM

### Role of dimension/layers

Reading the data:
```{r}
nguyen2dhistone = read.table("../cn/results/cnn_nguyen_2_conv2d-histone-dynamics.csv", header=TRUE, sep=",")
nguyen2dsplice = read.table("../cn/results/cnn_nguyen_2_conv2d-splice-dynamics.csv", header=TRUE, sep=",")
nguyen2dmotif = read.table("../cn/results/cnn_nguyen_2_conv2d-motif_discovery-dynamics.csv", header=TRUE, sep=",")
nguyen2dhistone$model = "CNN-Nguyen2D"
nguyen2dsplice$model = "CNN-Nguyen2D"
nguyen2dmotif$model = "CNN-Nguyen2D"

nguyen1dhistone = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-histone-dynamics.csv", header=TRUE, sep=",")
nguyen1dsplice = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-splice-dynamics.csv", header=TRUE, sep=",")
nguyen1dmotif = read.table("../cn/results/cnn_nguyen_conv1d_2_conv2d-motif_discovery-dynamics.csv", header=TRUE, sep=",")
nguyen1dhistone$model = "CNN-Nguyen2D+1D"
nguyen1dsplice$model = "CNN-Nguyen2D+1D"
nguyen1dmotif$model = "CNN-Nguyen2D+1D"

zeng2histone = read.table("../cn/results/cnn_zeng_2_conv2d-histone-dynamics.csv", header=TRUE, sep=",")
zeng2splice = read.table("../cn/results/cnn_zeng_2_conv2d-splice-dynamics.csv", header=TRUE, sep=",")
zeng2motif = read.table("../cn/results/cnn_zeng_2_conv2d-motif_discovery-dynamics.csv", header=TRUE, sep=",")
zeng2histone$model = "CNN-Zeng2"
zeng2splice$model = "CNN-Zeng2"
zeng2motif$model = "CNN-Zeng2"

zeng3histone = read.table("../cn/results/cnn_zeng_3_conv2d-histone-dynamics.csv", header=TRUE, sep=",")
zeng3splice = read.table("../cn/results/cnn_zeng_3_conv2d-splice-dynamics.csv", header=TRUE, sep=",")
zeng3motif = read.table("../cn/results/cnn_zeng_3_conv2d-motif_discovery-dynamics.csv", header=TRUE, sep=",")
zeng3histone$model = "CNN-Zeng3"
zeng3splice$model = "CNN-Zeng3"
zeng3motif$model = "CNN-Zeng3"

zeng4histone = read.table("../cn/results/cnn_zeng_4_conv2d-histone-dynamics.csv", header=TRUE, sep=",")
zeng4splice = read.table("../cn/results/cnn_zeng_4_conv2d-splice-dynamics.csv", header=TRUE, sep=",")
zeng4motif = read.table("../cn/results/cnn_zeng_4_conv2d-motif_discovery-dynamics.csv", header=TRUE, sep=",")
zeng4histone$model = "CNN-Zeng4"
zeng4splice$model = "CNN-Zeng4"
zeng4motif$model = "CNN-Zeng4"


## Appending all data
histone = rbind(nguyen2dhistone, nguyen1dhistone, zeng2histone, zeng3histone, zeng4histone)
str(histone)

splice = rbind(nguyen2dsplice, nguyen1dsplice, zeng2splice, zeng3splice, zeng4splice)
str(splice)

motif = rbind(nguyen2dmotif, nguyen1dmotif, zeng2motif, zeng3motif, zeng4motif)
str(motif)
```

Plotting Splice data:
```{r}
p = ggplot(splice, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl = ggplot(splice, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-dimension-layers-dynamics.pdf",height=6, width=7)
p
dev.off()

pdf("splice-dimension-layers-dynamics-loss.pdf",height=6, width=7)
pl
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl2 = ggplot(histone, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-dimension-layers-dynamics.pdf",height=6, width=7)
p2
dev.off()

pdf("histone-dimension-layers-dynamics-loss.pdf",height=6, width=7)
pl2
dev.off()
```

Plotting Motif data:
```{r}
p3 = ggplot(motif, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl3 = ggplot(motif, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-dimension-layers-dynamics.pdf",height=6, width=7)
p3
dev.off()

pdf("motif-dimension-layers-dynamics-loss.pdf",height=6, width=7)
pl3
dev.off()
```

### Role of encoding

Reading the data:
```{r}
## Splice
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-splice-dynamics.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-splice-dynamics.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-splice-dynamics.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-splice-dynamics.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-splice-dynamics.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-splice-dynamics.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

splice = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(splice)

## Histone
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-histone-dynamics.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-histone-dynamics.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-histone-dynamics.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-histone-dynamics.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-histone-dynamics.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-histone-dynamics.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

histone = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(histone)

## Motif
cnn1hot = read.table("../cn/results/deepram_conv1d_onehot-motif_discovery-dynamics.csv", header=TRUE, sep=",")
cnnembed = read.table("../cn/results/deepram_conv1d_embed-motif_discovery-dynamics.csv", header=TRUE, sep=",")
rnn1hot = read.table("../cn/results/deepram_recurrent_onehot-motif_discovery-dynamics.csv", header=TRUE, sep=",")
rnnembed = read.table("../cn/results/deepram_recurrent_embed-motif_discovery-dynamics.csv", header=TRUE, sep=",")
cnnrnn1hot = read.table("../cn/results/deepram_conv1d_recurrent_onehot-motif_discovery-dynamics.csv", header=TRUE, sep=",")
cnnrnnembed = read.table("../cn/results/deepram_conv1d_recurrent_embed-motif_discovery-dynamics.csv", header=TRUE, sep=",")

cnn1hot$model = "DeepRAM-CNN-OneHot"
cnnembed$model = "DeepRAM-CNN-Embed"
rnn1hot$model = "DeepRAM-RNN-OneHot"
rnnembed$model = "DeepRAM-RNN-Embed"
cnnrnn1hot$model = "DeepRAM-CNN-RNN-OneHot"
cnnrnnembed$model = "DeepRAM-CNN-RNN-Embed"

motif = rbind(cnn1hot, cnnembed, rnn1hot, rnnembed, cnnrnn1hot, cnnrnnembed)
str(motif)
```

Plotting Splice data:
```{r}
p = ggplot(splice, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl = ggplot(splice, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-embedding-dynamics.pdf",height=6, width=7)
p
dev.off()

pdf("splice-embedding-dynamics-loss.pdf",height=6, width=7)
pl
dev.off()
```

Plotting Histone data:
```{r}
p2 = ggplot(histone, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl2 = ggplot(histone, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-embedding-dynamics.pdf",height=6, width=7)
p2
dev.off()

pdf("histone-embedding-dynamics-loss.pdf",height=6, width=7)
pl2
dev.off()
```

Plotting Motif data:
```{r}
p3 = ggplot(motif, aes(x=epoch,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl3 = ggplot(motif, aes(x=epoch,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-embedding-dynamics.pdf",height=6, width=7)
p3
dev.off()

pdf("motif-embedding-dynamics-loss.pdf",height=6, width=7)
pl3
dev.off()
```

### Role of optimizer

Reading data:
```{r}
spliceadam = read.table("../nlp/splice/baseline_uci_adam256_history.csv",header=TRUE,sep=",")
splicesgd = read.table("../nlp/splice/baseline_uci_sgd256_history.csv",header=TRUE,sep=",")
spliceadam$model = "LSTM-AE-Adam"
spliceadam$data = "Splice"
splicesgd$model = "LSTM-AE-SGD"
splicesgd$data = "Splice"

histoneadam = read.table("../nlp/histone/baseline_histone_adam256_history.csv",header=TRUE,sep=",")
histonesgd = read.table("../nlp/histone/baseline_histone_sgd256_history.csv",header=TRUE,sep=",")
histoneadam$model = "LSTM-AE-Adam"
histoneadam$data = "Histone"
histonesgd$model = "LSTM-AE-SGD"
histonesgd$data = "Histone"

motifadam = read.table("../nlp/motif-discovery/discovery_baseline_adam256__history.csv",header=TRUE,sep=",")
motifsgd = read.table("../nlp/motif-discovery/discovery_baseline_sgd256__history.csv",header=TRUE,sep=",")
motifadam$model = "LSTM-AE-Adam"
motifadam$data = "Motif-discovery"
motifsgd$model = "LSTM-AE-SGD"
motifsgd$data = "Motif-discovery"

dat = rbind(spliceadam, splicesgd, histoneadam, histonesgd, motifadam, motifsgd)
str(dat)

dat = within(dat,data<-factor(data,levels=c("Splice", "Histone", "Motif-discovery")))
```

Plotting:
```{r}
p = ggplot(dat, aes(x=X,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
  facet_wrap(~data, scales = "free_x") +
    scale_color_brewer(palette="Paired") +
  xlab("Epoch") + ylab("Accuracy") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl = ggplot(dat, aes(x=X,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
  facet_wrap(~data, scales = "free") +
    scale_color_brewer(palette="Paired") +
  xlab("Epoch") + ylab("Loss") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("optimizer-dynamics.pdf",height=6, width=7)
p
dev.off()

pdf("optimizer-dynamics-loss.pdf",height=6, width=7)
pl
dev.off()
```

### Role of embedding size

Reading data:
```{r}
## splice
splice50 = read.table("../nlp/splice/uci_doc2vec_size50_history.csv", header=TRUE, sep=",")
splice100 = read.table("../nlp/splice/uci_doc2vec_size100_history.csv", header=TRUE, sep=",")
splice150 = read.table("../nlp/splice/uci_doc2vec_size150_history.csv", header=TRUE, sep=",")
splice200 = read.table("../nlp/splice/uci_doc2vec_size200_history.csv", header=TRUE, sep=",")

splice50$model = "doc2vec-size50"
splice100$model = "doc2vec-size100"
splice150$model = "doc2vec-size150"
splice200$model = "doc2vec-size200"

splice=rbind(splice50, splice100, splice150, splice200)


## histone
histone50 = read.table("../nlp/histone/doc2vec_histone_size50_history.csv", header=TRUE, sep=",")
histone100 = read.table("../nlp/histone/doc2vec_histone_size100_history.csv", header=TRUE, sep=",")
histone150 = read.table("../nlp/histone/doc2vec_histone_size150_history.csv", header=TRUE, sep=",")
histone200 = read.table("../nlp/histone/doc2vec_histone_size200_history.csv", header=TRUE, sep=",")

histone50$model = "doc2vec-size50"
histone100$model = "doc2vec-size100"
histone150$model = "doc2vec-size150"
histone200$model = "doc2vec-size200"

histone=rbind(histone50, histone100, histone150, histone200)

## motif
motif50 = read.table("../nlp/motif-discovery/discovery_doc2vec_size50_history.csv", header=TRUE, sep=",")
motif100 = read.table("../nlp/motif-discovery/discovery_doc2vec_size100_history.csv", header=TRUE, sep=",")
motif150 = read.table("../nlp/motif-discovery/discovery_doc2vec_size150_history.csv", header=TRUE, sep=",")
motif200 = read.table("../nlp/motif-discovery/discovery_doc2vec_size200_history.csv", header=TRUE, sep=",")

motif50$model = "doc2vec-size50"
motif100$model = "doc2vec-size100"
motif150$model = "doc2vec-size150"
motif200$model = "doc2vec-size200"

motif=rbind(motif50, motif100, motif150, motif200)
```

Plotting Splice data:
```{r}
splice = within(splice, model<-factor(model))
splice = within(splice, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))

p = ggplot(splice, aes(x=X,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl = ggplot(splice, aes(x=X,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-embed-size-dynamics.pdf",height=6, width=7)
p
dev.off()

pdf("splice-embed-size-dynamics-loss.pdf",height=6, width=7)
pl
dev.off()
```

Plotting Histone data:
```{r}
histone = within(histone, model<-factor(model))
histone = within(histone, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))


p2 = ggplot(histone, aes(x=X,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl2 = ggplot(histone, aes(x=X,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-embed-size-dynamics.pdf",height=6, width=7)
p2
dev.off()

pdf("histone-embed-size-dynamics-loss.pdf",height=6, width=7)
pl2
dev.off()
```

Plotting Motif data:
```{r}
motif = within(motif, model<-factor(model))
motif = within(motif, model<- factor(model, levels=c("doc2vec-size50", "doc2vec-size100", "doc2vec-size150", "doc2vec-size200")))


p3 = ggplot(motif, aes(x=X,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl3 = ggplot(motif, aes(x=X,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-embed-size-dynamics.pdf",height=6, width=7)
p3
dev.off()

pdf("motif-embed-size-dynamics-loss.pdf",height=6, width=7)
pl3
dev.off()
```


### Role of batch size

Reading data:
```{r}
## splice
splice32 = read.table("../nlp/splice/uci_ae_adam32_reconstruction_history.csv", header=TRUE, sep=",")
splice256 = read.table("../nlp/splice/uci_ae_adam256_reconstruction_history.csv", header=TRUE, sep=",")
splice1024 = read.table("../nlp/splice/uci_ae_adam1024_reconstruction_history.csv", header=TRUE, sep=",")

splice32$model = "LSTM-AE-size32"
splice256$model = "LSTM-AE-size256"
splice1024$model = "LSTM-AE-size1024"
splice=rbind(splice32, splice256, splice1024)


## histone
histone32 = read.table("../nlp/histone/ae_histone_adam32_reconstruction_history.csv", header=TRUE, sep=",")
histone256 = read.table("../nlp/histone/ae_histone_adam256_reconstruction_history.csv", header=TRUE, sep=",")
histone1024 = read.table("../nlp/histone/ae_histone_adam1024_reconstruction_history.csv", header=TRUE, sep=",")

histone32$model = "LSTM-AE-size32"
histone256$model = "LSTM-AE-size256"
histone1024$model = "LSTM-AE-size1024"
histone=rbind(histone32, histone256, histone1024)

## motif
motif32 = read.table("../nlp/motif-discovery/discovery_ae_adam32__reconstruction_history.csv", header=TRUE, sep=",")
motif256 = read.table("../nlp/motif-discovery/discovery_ae_adam256__reconstruction_history.csv", header=TRUE, sep=",")
motif1024 = read.table("../nlp/motif-discovery/discovery_ae_adam1024__reconstruction_history.csv", header=TRUE, sep=",")

motif32$model = "LSTM-AE-size32"
motif256$model = "LSTM-AE-size256"
motif1024$model = "LSTM-AE-size1024"
motif=rbind(motif32, motif256, motif1024)
```

Plotting Splice data:
```{r}
splice = within(splice, model<-factor(model))
splice = within(splice, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))

p = ggplot(splice, aes(x=X,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl = ggplot(splice, aes(x=X,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Splice data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("splice-batch-size-dynamics.pdf",height=6, width=7)
p
dev.off()

pdf("splice-batch-size-dynamics-loss.pdf",height=6, width=7)
pl
dev.off()
```

Plotting Histone data:
```{r}
histone = within(histone, model<-factor(model))
histone = within(histone, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))


p2 = ggplot(histone, aes(x=X,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl2 = ggplot(histone, aes(x=X,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Histone data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("histone-batch-size-dynamics.pdf",height=6, width=7)
p2
dev.off()

pdf("histone-batch-size-dynamics-loss.pdf",height=6, width=7)
pl2
dev.off()
```

Plotting Motif data:
```{r}
motif = within(motif, model<-factor(model))
motif = within(motif, model<- factor(model, levels=c("LSTM-AE-size32", "LSTM-AE-size256", "LSTM-AE-size1024")))


p3 = ggplot(motif, aes(x=X,y=accuracy, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_accuracy,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Accuracy") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pl3 = ggplot(motif, aes(x=X,y=loss, color=model))+
  geom_line(size=1) + geom_line(aes(y=val_loss,color=model), linetype="dotted", size=1)+
    scale_color_brewer(palette="YlGnBu") +
  xlab("Epoch") + ylab("Loss") +
  ggtitle("Motif discovery data") +
  theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.5), angle=90, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.4), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(0.8)), 
    legend.title=element_blank(),
    legend.position = "bottom",
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    strip.text = element_text(size = 17)
  )

pdf("motif-batch-size-dynamics.pdf",height=6, width=7)
p3
dev.off()

pdf("motif-batch-size-dynamics-loss.pdf",height=6, width=7)
pl3
dev.off()
```


# Final plots in the manuscript (JMLR)

Necessary package:
```{r}
library(ggplot2)
```

## Figure in `fig:histone-history-1`

Reading the data:
```{r}
v1 = read.table("../cnn/csv/histone/v1.csv", header=TRUE, sep=",")
str(v1)

## add regularization type:
v1$method = "no-regularization"

v2 = read.table("../cnn/csv/histone/v2.csv", header=TRUE, sep=",")
str(v2)

## add regularization type:
v2$method = "L2-regularization"

## Append both datasets:
dat = rbind(v1,v2)
str(dat)
dat = within(dat, method<-factor(method,levels=c("no-regularization", "L2-regularization")))
```

Creating the plots:
```{r}
p1 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.6,0.8))+
  facet_wrap(~method)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p1

pdf("two-conv2d-acc.pdf",height=4, width=8)
p1
dev.off()
```

```{r}
p2 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.45,0.85))+
  facet_wrap(~method)+
#  ggtitle("Loss")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p2

pdf("two-conv2d-loss.pdf",height=4, width=8)
p2
dev.off()
```

## Figure in `fig:histone-history-2`

Reading the data:
```{r}
v3 = read.table("../cnn/csv/histone/v3.csv", header=TRUE, sep=",")
str(v3)

## add regularization type:
v3$method = "no-regularization"

v4 = read.table("../cnn/csv/histone/v4.csv", header=TRUE, sep=",")
str(v4)

## add regularization type:
v4$method = "L2-regularization"

## Append both datasets:
dat = rbind(v3,v4)
str(dat)
dat = within(dat, method<-factor(method,levels=c("no-regularization", "L2-regularization")))
```

Creating the plots:
```{r}
p3 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.6,0.99))+
  facet_wrap(~method)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p3

pdf("one-conv1d-two-conv2d-acc.pdf",height=4, width=8)
p3
dev.off()
```

```{r}
p4 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.05,1.45))+
  facet_wrap(~method)+
#  ggtitle("Loss")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p4

pdf("one-conv1d-two-conv2d-loss.pdf",height=4, width=8)
p4
dev.off()
```

## Figure in `fig:motif-discovery-history`

Reading the data:
```{r}
v1 = read.table("../cnn/csv/motif-discovery/v1.csv", header=TRUE, sep=",")
str(v1)

## add regularization type:
v1$method = "2 2D conv layers"

v2 = read.table("../cnn/csv/motif-discovery/v2.csv", header=TRUE, sep=",")
str(v2)

## add regularization type:
v2$method = "3 2D conv layers"

v3 = read.table("../cnn/csv/motif-discovery/v3.csv", header=TRUE, sep=",")
str(v3)

## add regularization type:
v3$method = "4 2D conv layers"


## Append both datasets:
dat = rbind(v1,v2,v3)
str(dat)
dat = within(dat, method<-factor(method))
```

Creating the plots:
```{r}
p5 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.5,0.8))+
  facet_wrap(~method)+
  xlab("")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p5

pdf("two-to-four-layers-acc.pdf",height=4, width=12)
p5
dev.off()
```

```{r}
p6 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.35,2.15))+
  facet_wrap(~method)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_blank()
  )
p6

pdf("two-to-four-layers-loss.pdf",height=4, width=12)
p6
dev.off()
```

## Figure in `fig:motif-discovery-reg-history`

Reading the data:
```{r}
v3 = read.table("../cnn/csv/motif-discovery/v3.csv", header=TRUE, sep=",")
str(v3)

## add regularization type:
v3$method = "no-regularization"

v4 = read.table("../cnn/csv/motif-discovery/v4.csv", header=TRUE, sep=",")
str(v4)

## add regularization type:
v4$method = "L2-regularization"

## Append both datasets:
dat = rbind(v3,v4)
str(dat)
dat = within(dat, method<-factor(method,levels=c("no-regularization", "L2-regularization")))
```

Creating the plots:
```{r}
p7 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.45,0.8))+
  facet_wrap(~method)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p7

pdf("four-layer-reg-acc.pdf",height=4, width=8)
p7
dev.off()
```

```{r}
p8 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.35,2.15))+
  facet_wrap(~method)+
#  ggtitle("Loss")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p8

pdf("four-layer-reg-loss.pdf",height=4, width=8)
p8
dev.off()
```

## Figure in `fig:deepram-history`

Reading data:
```{r}
emb.cnn = read.table("../cnn/csv/deepram/embedding/conv1d/v1.csv", header=TRUE, sep=",")
emb.cnn$model = "CNN"
emb.cnn$encoding = "embedding"

emb.cnnrnn = read.table("../cnn/csv/deepram/embedding/conv1d-recurrent/v1.csv", header=TRUE, sep=",")
emb.cnnrnn$model = "CNN-RNN"
emb.cnnrnn$encoding = "embedding"

emb.rnn = read.table("../cnn/csv/deepram/embedding/recurrent/v1.csv", header=TRUE, sep=",")
emb.rnn$model = "RNN"
emb.rnn$encoding = "embedding"

one.cnn = read.table("../cnn/csv/deepram/onehot/conv1d/v1.csv", header=TRUE, sep=",")
one.cnn$model = "CNN"
one.cnn$encoding = "one-hot"

one.cnnrnn = read.table("../cnn/csv/deepram/onehot/conv1d-recurrent/v1.csv", header=TRUE, sep=",")
one.cnnrnn$model = "CNN-RNN"
one.cnnrnn$encoding = "one-hot"

one.rnn = read.table("../cnn/csv/deepram/onehot/recurrent/v1.csv", header=TRUE, sep=",")
one.rnn$model = "RNN"
one.rnn$encoding = "one-hot"

## Appending data:
dat = rbind(emb.cnn, emb.cnnrnn, emb.rnn, one.cnn, one.cnnrnn, one.rnn)
str(dat)
dat = within(dat, model<-factor(model))
dat = within(dat, encoding <- factor(encoding))
```

Creating plots:
```{r}
p9 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.45,0.8))+
  facet_grid(encoding~model)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p9

pdf("cnn-rnn-acc.pdf",height=8, width=12)
p9
dev.off()
```

```{r}
p10 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.4,0.7))+
  facet_grid(encoding~model)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p10

pdf("cnn-rnn-loss.pdf",height=8, width=12)
p10
dev.off()
```

## Figure in `fig:cifar-10-comparison`

Reading in data:
```{r}
cifar = read.table("../cnn/csv/cifar-10/log.csv", header=TRUE, sep=",")
cifar$data = "CIFAR-10"
cifar$epoch = 0:39
str(cifar)
## keeping only the first 30 epochs
cifar2 = cifar[1:30,]
str(cifar2)

motif = read.table("../cnn/csv/motif-discovery/v3.csv", header=TRUE, sep=",")
motif$data = "motif-discovery"
str(motif)

## Append data:
dat = rbind(cifar2, motif)
dat = within(dat, data<-factor(data))
str(dat)
```

Creating the plots:
```{r}
p11 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.4,0.85))+
  facet_wrap(~data)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p11

pdf("cifar-10-comparison-acc.pdf",height=4, width=8)
p11
dev.off()
```

```{r}
p12 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.35,2.15))+
  facet_wrap(~data)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p12

pdf("cifar-10-comparison-loss.pdf",height=4, width=8)
p12
dev.off()
```

## Figure in `fig:optimizer`

Reading the data:
```{r}
adam = read.table("../nlp/UCI/baseline_uci_adam256_history.csv", header=TRUE, sep=",")
str(adam)
adam$epoch = adam$X
adam$optimizer = "Adam"

sgd = read.table("../nlp/UCI/baseline_uci_sgd256_history.csv", header=TRUE, sep=",")
str(sgd)
sgd$epoch = sgd$X
sgd$optimizer = "SGD"

## Appending the data:
dat = rbind(adam,sgd)
str(dat)
dat = within(dat, optimizer<-factor(optimizer))
```

Creating the plots:
```{r}
p13 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.5,0.99))+
  facet_wrap(~optimizer, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p13

pdf("baseline-uci-acc.pdf",height=4, width=8)
p13
dev.off()
```

```{r}
p14 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.1,1.2))+
  facet_wrap(~optimizer, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p14

pdf("baseline-uci-loss.pdf",height=4, width=8)
p14
dev.off()
```

Reading the data:
```{r}
adam = read.table("../nlp/CHIP/baseline_chip_adam256_history.csv", header=TRUE, sep=",")
str(adam)
adam$epoch = adam$X
adam$optimizer = "Adam"

sgd = read.table("../nlp/CHIP/baseline_chip_sgd256_history.csv", header=TRUE, sep=",")
str(sgd)
sgd$epoch = sgd$X
sgd$optimizer = "SGD"

## Appending the data:
dat = rbind(adam,sgd)
str(dat)
dat = within(dat, optimizer<-factor(optimizer))
```

Creating the plots:
```{r}
p13_2 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.5,0.99))+
  facet_wrap(~optimizer, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p13_2

pdf("baseline-chip-acc.pdf",height=4, width=8)
p13_2
dev.off()
```

```{r}
p14_2 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.1,1.2))+
  facet_wrap(~optimizer, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p14_2

pdf("baseline-chip-loss.pdf",height=4, width=8)
p14_2
dev.off()
```

## Figure in `fig:splice-promoter-conv2d-history`

Reading the data:
```{r}
splice = read.table("../cnn/csv/splice-promoter/splice-conv2D.csv", header=TRUE, sep=",")
str(splice)

splice$method = "splice"

promoter = read.table("../cnn/csv/splice-promoter/promoter-conv2D.csv", header=TRUE, sep=",")
str(promoter)

promoter$method = "promoter"

## Append both datasets:
dat = rbind(splice,promoter)
dat = within(dat, method<-factor(method,levels=c("splice", "promoter")))
str(dat)
```

```{r}
p15 = ggplot(dat, aes(x=epoch, y=accuracy))+
  geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.45,1.0))+
  facet_wrap(~method)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p15

pdf("one-conv2d-acc.pdf",height=4, width=8)
p15
dev.off()
```

```{r}
p16 = ggplot(dat, aes(x=epoch, y=loss))+
  geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.0,0.72))+
  facet_wrap(~method)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p16

pdf("one-conv2d-loss.pdf",height=4, width=8)
p16
dev.off()
```

## Figure in `fig:splice-promoter-conv1d-history`

Reading the data:
```{r}
splice = read.table("../cnn/csv/splice-promoter/splice-conv1D.csv", header=TRUE, sep=",")
str(splice)

splice$method = "splice"

promoter = read.table("../cnn/csv/splice-promoter/promoter-conv1D.csv", header=TRUE, sep=",")
str(promoter)

promoter$method = "promoter"

## Append both datasets:
dat = rbind(splice,promoter)
dat = within(dat, method<-factor(method,levels=c("splice", "promoter")))
str(dat)
```

```{r}
p17 = ggplot(dat, aes(x=epoch, y=accuracy))+
  geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.375,1.0))+
  facet_wrap(~method)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p17

pdf("one-conv1d-acc.pdf",height=4, width=8)
p15
dev.off()
```

```{r}
p18 = ggplot(dat, aes(x=epoch, y=loss))+
  geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.0,1.05))+
  facet_wrap(~method)+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p18

pdf("one-conv1d-loss.pdf",height=4, width=8)
p18
dev.off()
```

## Figure in `fig:batch_size`
Reading the data:
```{r}
batch32 = read.table("../nlp/CHIP/ae_chip_adam32_reconstruction_history.csv", header=TRUE, sep=",")
str(batch32)
batch32$epoch = batch32$X
batch32$batch_size = 32
# adam$optimizer = "Adam"

batch256 = read.table("../nlp/CHIP/ae_chip_adam256_reconstruction_history.csv", header=TRUE, sep=",")
str(batch256)
batch256$epoch = batch256$X
batch256$batch_size = 256
# sgd$optimizer = "SGD"

batch1024 = read.table("../nlp/CHIP/ae_chip_adam1024_reconstruction_history.csv", header=TRUE, sep=",")
str(batch1024)
batch1024$epoch = batch1024$X
batch1024$batch_size = 1024

## Appending the data:
dat = rbind(batch32,batch256,batch1024)
str(dat)
dat = within(dat, batch_size<-factor(batch_size))
```
Creating the plots:
```{r}
p19 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.3,0.6))+
  facet_wrap(~batch_size, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p19

pdf("batchsize-chip-reconstruction-acc.pdf",height=4, width=12)
p19
dev.off()
```
```{r}
p20 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(1.0,1.4))+
  facet_wrap(~batch_size, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p20

pdf("batchsize-chip-reconstruction-loss.pdf",height=4, width=12)
p20
dev.off()
```

## Figure in `fig:doc2vec`
Reading the data:
```{r}
embedding_50 = read.table("../nlp/viridae/doc2vec_viridae_size50_history.csv", header=TRUE, sep=",")
str(embedding_50)
embedding_50$epoch = embedding_50$X
embedding_50$embedding_size = 50

embedding_100 = read.table("../nlp/viridae/doc2vec_viridae_size100_history.csv", header=TRUE, sep=",")
str(embedding_100)
embedding_100$epoch = embedding_100$X
embedding_100$embedding_size = 100

embedding_150 = read.table("../nlp/viridae/doc2vec_viridae_size150_history.csv", header=TRUE, sep=",")
str(embedding_150)
embedding_150$epoch = embedding_150$X
embedding_150$embedding_size = 150

embedding_200 = read.table("../nlp/viridae/doc2vec_viridae_size200_history.csv", header=TRUE, sep=",")
str(embedding_200)
embedding_200$epoch = embedding_200$X
embedding_200$embedding_size = 200


## Appending the data:
dat = rbind(embedding_50,embedding_100,embedding_150,embedding_200)
str(dat)
dat = within(dat, embedding_size<-factor(embedding_size))
```
Creating the plots:
```{r}
p21 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.45,0.99))+
  facet_wrap(~embedding_size, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p21

pdf("embedding-size-viridae-acc.pdf",height=8, width=8)
p21
dev.off()
```
```{r}
p22 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.0,1.0))+
  facet_wrap(~embedding_size, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p22

pdf("embedding-size-viridae-loss.pdf",height=8, width=8)
p22
dev.off()
```
## Figure in `lstm-layer`
Reading the data:
```{r}
CHIP = read.table("../nlp/CHIP/baseline_chip_sgd256_history.csv", header=TRUE, sep=",")
str(CHIP)
CHIP$epoch = CHIP$X
CHIP$dataset = "CHIP"

UCI = read.table("../nlp/UCI/baseline_uci_sgd256_history.csv", header=TRUE, sep=",")
str(UCI)
UCI$epoch = UCI$X
UCI$dataset = "UCI"


## Appending the data:
dat = rbind(CHIP, UCI)
str(dat)
dat = within(dat, dataset<-factor(dataset))
```
Creating the plots:
```{r}
p23 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.5,0.99))+
  facet_wrap(~dataset, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p23

pdf("lstm-layer-acc.pdf",height=4, width=12)
p23
dev.off()
```
```{r}
p24 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.0,1.2))+
  facet_wrap(~dataset, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p24

pdf("lstm-layer-loss.pdf",height=4, width=12)
p24
dev.off()
```


## Figure in `lstm-ae`
Reading the data:
```{r}
CHIP = read.table("../nlp/CHIP/ae_chip_adam256_prediction_history.csv", header=TRUE, sep=",")
str(CHIP)
CHIP$epoch = CHIP$X
CHIP$dataset = "ChIP-seq toy"

UCI = read.table("../nlp/UCI/ae_uci_prediction_history.csv", header=TRUE, sep=",")
str(UCI)
UCI$epoch = UCI$X
UCI$dataset = "splice"


## Appending the data:
dat = rbind(CHIP, UCI)
str(dat)
dat = within(dat, dataset<-factor(dataset))
```
Creating the plots:
```{r}
p25 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.5,0.99))+
  facet_wrap(~dataset, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p25

pdf("lstm-ae-acc.pdf",height=4, width=8)
p25
dev.off()
```
```{r}
p26 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.0,1.2))+
  facet_wrap(~dataset, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p26

pdf("lstm-ae-loss.pdf",height=4, width=8)
p26
dev.off()
```


## Figure in `doc2vec`
Reading the data:
```{r}
CHIP = read.table("../nlp/CHIP/doc2vec_chip_size30_history.csv", header=TRUE, sep=",")
str(CHIP)
CHIP$epoch = CHIP$X
CHIP$dataset = "ChIP-seq toy"

UCI = read.table("../nlp/UCI/doc2vec_uci_size30_history.csv", header=TRUE, sep=",")
str(UCI)
UCI$epoch = UCI$X
UCI$dataset = "splice"


## Appending the data:
dat = rbind(CHIP, UCI)
str(dat)
dat = within(dat, dataset<-factor(dataset))
```

Creating the plots:
```{r}
p27 = ggplot(dat, aes(x=epoch, y=accuracy))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_accuracy),col="darkgreen", size=1.5)+
  ylim(c(0.47,0.57))+
  facet_wrap(~dataset, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p27

pdf("doc2vec-acc.pdf",height=4, width=8)
p27
dev.off()
```

```{r}
p28 = ggplot(dat, aes(x=epoch, y=loss))+geom_line(col="blue4", size=1.5)+
  geom_line(aes(y=val_loss),col="darkgreen", size=1.5)+
  ylim(c(0.65,1.2))+
  facet_wrap(~dataset, scales="free_x")+
     theme(
    plot.title = element_text(hjust=0.5, size=rel(1.6)),
    axis.title.x = element_text(size=rel(1.4)),
    axis.title.y = element_text(size=rel(1.4), angle=90, vjust=0.5, hjust=0.5),
    axis.text.x = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    axis.text.y = element_text(colour="grey", size=rel(1.2), angle=0, hjust=.5, vjust=.5, face="plain"),
    legend.text=element_text(size=rel(1.2)), legend.title=element_text(size=rel(1.5)),
    panel.background = element_blank(),
    axis.line = element_line(colour = "grey"),
    legend.position="none",
    strip.text = element_text(size = 17)
  )
p28

pdf("doc2vec-loss.pdf",height=4, width=8)
p28
dev.off()
```






